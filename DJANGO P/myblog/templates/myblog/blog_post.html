{% extends 'myblog/base.html' %}

{% block title %}{{ post.title }} ‚Äî MyBlog{% endblock %}

{% block content %}
<article class="single-post">
    <header class="single-post-header">
        <h1 class="single-post-title">{{ post.title }}</h1>

        <div class="single-post-meta">
            {% if post.published_date %}
                <span>–û–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–æ: {{ post.published_date|date:"d.m.Y H:i" }}</span>
            {% else %}
                <span class="badge badge-muted">–ß–µ—Ä–Ω–µ—Ç–∫–∞</span>
            {% endif %}
            <span>–ê–≤—Ç–æ—Ä: {{ post.author }}</span>
        </div>

        {% if user.is_authenticated %}
            <div class="single-post-actions">
                <a href="{% url 'post_edit' pk=post.pk %}" class="btn btn-primary">‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏</a>

                {% if not post.published_date %}
                    <a href="{% url 'post_publish' pk=post.pk %}" class="btn btn-success">
                        ‚úÖ –û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏
                    </a>
                {% endif %}

                <a href="{% url 'post_remove' pk=post.pk %}" class="btn btn-danger">
                    üóë –í–∏–¥–∞–ª–∏—Ç–∏
                </a>
            </div>
        {% endif %}
    </header>

    <div class="single-post-body">
        <p>{{ post.text|linebreaksbr }}</p>
    </div>

    <section class="comments-section">
        <div class="comments-header">
            <h2>–ö–æ–º–µ–Ω—Ç–∞—Ä—ñ ({{ post.all_comments|length }})</h2>
            <a href="{% url 'add_comment_to_post' pk=post.pk %}" class="btn btn-outline">
                –î–æ–¥–∞—Ç–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä
            </a>
        </div>

        {% for comment in post.all_comments %}
            <div class="comment-card">
                <div class="comment-meta">
                    <strong>{{ comment.author }}</strong>
                    <span>{{ comment.created_date|date:"d.m.Y H:i" }}</span>
                </div>
                <p class="comment-text">{{ comment.text|linebreaksbr }}</p>
            </div>
        {% empty %}
            <p>–©–µ –Ω—ñ—Ö—Ç–æ –Ω–µ –∑–∞–ª–∏—à–∏–≤ –∫–æ–º–µ–Ω—Ç–∞—Ä. –ë—É–¥—å –ø–µ—Ä—à–æ—é üí¨</p>
        {% endfor %}
    </section>
</article>
{% endblock %}
